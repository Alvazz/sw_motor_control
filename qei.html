
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Quadrature Encoder Input &mdash; Motor Control Platform Software Guide v2.0.0 documentation</title>
    <link rel="stylesheet" href="_static/xdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://mathjax.connectmv.com/MathJax.js"></script>
    <script type="text/javascript" src="_static/xcomment.js"></script>
    <link rel="top" title="Motor Control Platform Software Guide v2.0.0 documentation" href="index.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="Hall Sensor Interface" href="hsi.html" /> 

<script>
function setheight() {
h1 = document.getElementById('d1').style.height;
h2 = document.getElementById('d2').style.height;

if (parseInt(h1) > parseInt(h2)) {
document.getElementById('d2').style.height=h1 + "px";
}
else {
document.getElementById('d1').style.height=h2 + "px";
}

}
</script>
</head>

<body onload="setheight();">

  

    <div class="document" id='d1'>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
<div style="float: right">
<a href="hsi.html"
                        title="previous chapter"> &lt&lt </a>
<a href="api.html"
                        title="next chapter"> &gt&gt </a></p>
</div>

            
  <div class="section" id="quadrature-encoder-input">
<h1>Quadrature Encoder Input<a class="headerlink" href="#quadrature-encoder-input" title="Permalink to this headline">¶</a></h1>
<p>The quadrature encoder input (QEI) module is provided with a library for both running the thread that handles the direct interface to the pins and also for retrieving
and calculating the appropriate information from that thread.</p>
<p>The particular interface that is implemented utilises three signals comprising of two quadrature output (A and B) and an index output (I). A and B provide incremental
information while I indicates a return to 0 or origin. The signals A and B are provided out of phase so that the direction of rotation can be resolved.</p>
<blockquote>
<div><img alt="_images/QeiOutput.pdf" class="align-center" src="_images/QeiOutput.pdf" />
</div></blockquote>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The QEI module provides one or multiple QEI device versions of the server. If more than one QEI device is interfaced to the XMOS device, then the designer can
opt to use multiple single-device QEI server threads, or one multi-device thread.</p>
<p>The multiple-QEI service loop has a worst-case timing of 1.4us, therefore being able to service two 1024 position QEI devices spinning at 20kRPM.</p>
<p></p>
</div>
<div class="section" id="qei-server-usage">
<h2>QEI Server Usage<a class="headerlink" href="#qei-server-usage" title="Permalink to this headline">¶</a></h2>
<p>To initiate the service the following include is required as well as the function call shown. This defines the ports that are required to read the interface and
the channel that will be utilised by the client thread.  The compile time constant <em>NUMBER_OF_MOTORS</em> is used to determine how many clients and ports are
serviced by the multi-device QEI server.</p>
<div class="highlight-none"><div class="highlight"><pre>#include &quot;qei_server.h&quot;

void do_qei( streaming chanend c_qei, port in pQEI);

void do_qei_multiple( streaming chanend c_qei[NUMBER_OF_MOTORS], port in pQEI[NUMBER_OF_MOTORS]);
</pre></div>
</div>
</div>
<div class="section" id="qei-client-usage">
<h2>QEI Client Usage<a class="headerlink" href="#qei-client-usage" title="Permalink to this headline">¶</a></h2>
<p>To access the information provided by the quadrature encoder the functions listed below can used.</p>
<div class="highlight-none"><div class="highlight"><pre>#include &quot;qei_client.h&quot;

{ unsigned, unsigned, unsigned } get_qei_data( chanend c_qei );
</pre></div>
</div>
<p>The three values are the speed, position and valid state. The position value is returned as a count
from the index zero position and speed is returned in revolutions per minute (RPM).</p>
<p>The third value indicates whether the QEI interface has received an index signal and therefore that the position is
valid.</p>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" id='d2'>
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Motor Control Platform Software Guide (2.0.0)</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="apps.html">Motor Control Platform Example Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="blocks.html">Processing Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="display.html">Display and Shared IO Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="pwm.html">Pulse Width Modulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="adc.html">Analogue to Digital Converter (ADC) Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="comms-high.html">Application Level Communications Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="hsi.html">Hall Sensor Interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Quadrature Encoder Input</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qei-server-usage">QEI Server Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qei-client-usage">QEI Client Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resource usage</a></li>
</ul>

<div id="searchbox" style="display: none;margin-bottom: 10px;">
  <h3>Search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>



    <div class="footer">
    </div>
  </body>
</html>



